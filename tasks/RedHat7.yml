---
  - name: Add onlyoffice repo
    ansible.builtin.yum:
      name: "{{ onlyoffice_repo }}"
    become: yes

  - name: Install epel repo
    ansible.builtin.yum: 
      name: epel-release
    become: yes

  - name: Install dependency
    ansible.builtin.yum:
      name: "{{ item.name }}"
    with_items:
      - { name: "{{ msttcore_fonts }}", state: present }
      - { name: "{{ nginx_repo }}", state: present }
    become: yes

  - name: Set ds server port (if configured)
    lansible.builtin.ineinfile:
      path: /root/.bashrc
      line: export DS_PORT={{ ds_server_port }}
    when:
      - ds_server_port
    become: yes

  - name: Install documentserver from repo
    ansible.builtin.yum:
      name: "{{ package_name }}"
      update_cache: yes
      state: latest
    become: yes
    when: package_url | length == 0

  - name: Install the documentserver by URL
    ansible.builtin.yum:
      name: "{{ package_url }}"
      state: present
      validate_certs: yes
    when: package_url | length > 0
